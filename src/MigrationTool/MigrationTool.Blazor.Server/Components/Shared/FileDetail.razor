@using MigrationTool.Core.Abstractions.Models

<div class="file-detail">
    @if (FileInfo != null)
    {
        <div class="file-header">
            <div class="file-icon">@GetFileIcon(FileInfo.Name)</div>
            <div class="file-info">
                <h3 class="file-name">@FileInfo.Name</h3>
                <div class="file-path">@FileInfo.Path</div>
            </div>
        </div>

        <div class="file-stats">
            <div class="stat-item">
                <span class="stat-icon">üìä</span>
                <span class="stat-label">Lines:</span>
                <span class="stat-value">@FileInfo.LineCount</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">üî§</span>
                <span class="stat-label">Classes:</span>
                <span class="stat-value">@FileInfo.Classes.Count()</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">üß©</span>
                <span class="stat-label">Interfaces:</span>
                <span class="stat-value">@FileInfo.Classes.Count(c => c.Kind == TypeKind.Interface)</span>
            </div>
        </div>

        @if (!string.IsNullOrEmpty(FileInfo.Namespace))
        {
            <div class="detail-section">
                <h4>üì¶ Namespace</h4>
                <div class="namespace-box">
                    <code>@FileInfo.Namespace</code>
                </div>
            </div>
        }

        @if (FileInfo.Usings.Any())
        {
            <div class="detail-section">
                <h4>üìö Using Statements (@FileInfo.Usings.Count())</h4>
                <div class="using-list">
                    @foreach (var usingStmt in FileInfo.Usings.OrderBy(u => u))
                    {
                        <div class="using-item">
                            <span class="using-keyword">using</span>
                            <code>@usingStmt</code>;
                        </div>
                    }
                </div>
            </div>
        }

        @if (FileInfo.Classes.Any())
        {
            <div class="detail-section">
                <h4>üî∑ Classes & Interfaces (@FileInfo.Classes.Count())</h4>
                <div class="classes-list">
                    @foreach (var cls in FileInfo.Classes.OrderBy(c => c.Kind).ThenBy(c => c.Name))
                    {
                        <div class="class-item @(cls.Kind == TypeKind.Interface ? "interface" : "class")">
                            <div class="class-header">
                                <span class="class-icon">@(cls.Kind == TypeKind.Interface ? "üî∑" : "üîπ")</span>
                                <span class="class-keyword">@cls.Kind.ToString().ToLowerInvariant()</span>
                                <strong>@cls.Name</strong>
                            </div>
                            
                            @if (cls.Methods.Any() || cls.Properties.Any())
                            {
                                <div class="class-members">
                                    @if (cls.Properties.Any())
                                    {
                                        <div class="members-section">
                                            <div class="members-title">Properties (@cls.Properties.Count())</div>
                                            @foreach (var prop in cls.Properties.OrderBy(p => p.Name))
                                            {
                                                <div class="member-item">
                                                    <span class="member-icon">üî∏</span>
                                                    <code>@(prop.Type ?? "object") @prop.Name</code>
                                                </div>
                                            }
                                        </div>
                                    }
                                    
                                    @if (cls.Methods.Any())
                                    {
                                        <div class="members-section">
                                            <div class="members-title">Methods (@cls.Methods.Count())</div>
                                            @foreach (var method in cls.Methods.OrderBy(m => m.Name))
                                            {
                                                <div class="member-item">
                                                    <span class="member-icon">‚öôÔ∏è</span>
                                                    <code>@(method.ReturnType ?? "void") @method.Name</code>
                                                </div>
                                            }
                                        </div>
                                    }
                                </div>
                            }
                            
                            @if (cls.Tests.Any())
                            {
                                <div class="tests-section">
                                    <div class="tests-title">üß™ Tests (@cls.Tests.Count())</div>
                                    @foreach (var test in cls.Tests.OrderBy(t => t.Name))
                                    {
                                        <div class="test-item">
                                            <span class="test-icon">‚úÖ</span>
                                            <code>@test.Name</code>
                                            <span class="test-framework">[@test.Framework]</span>
                                        </div>
                                    }
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        }
    }
    else
    {
        <div class="file-detail-empty">
            <div class="empty-icon">üìÑ</div>
            <h3>No File Selected</h3>
            <p>Select a file from the tree to view its details</p>
        </div>
    }
</div>

@code {
    [Parameter] public SourceFileInfo? FileInfo { get; set; }

    private string GetFileIcon(string fileName)
    {
        if (fileName.EndsWith(".cs")) return "üìÑ";
        if (fileName.EndsWith(".csproj")) return "üì¶";
        if (fileName.EndsWith(".sln")) return "üìã";
        if (fileName.EndsWith(".json")) return "üîß";
        if (fileName.EndsWith(".xml")) return "üìù";
        return "üìÑ";
    }

}

<style>
    .file-detail {
        height: 100%;
        overflow-y: auto;
        padding: 1.5rem;
        background: white;
        border-radius: 8px;
    }

    .file-header {
        display: flex;
        gap: 1rem;
        align-items: flex-start;
        margin-bottom: 1.5rem;
        padding-bottom: 1.5rem;
        border-bottom: 2px solid var(--border-color);
    }

    .file-icon {
        font-size: 3rem;
        line-height: 1;
    }

    .file-info {
        flex: 1;
    }

    .file-name {
        margin: 0 0 0.5rem 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text-color);
    }

    .file-path {
        font-family: 'Consolas', 'Monaco', monospace;
        font-size: 0.85rem;
        color: var(--text-muted);
        word-break: break-all;
    }

    .file-stats {
        display: flex;
        gap: 2rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
    }

    .stat-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.95rem;
    }

    .stat-icon {
        font-size: 1.2rem;
    }

    .stat-label {
        color: var(--text-muted);
        font-weight: 500;
    }

    .stat-value {
        font-weight: 700;
        color: var(--primary-color);
    }

    .detail-section {
        margin-bottom: 2rem;
    }

    .detail-section h4 {
        margin: 0 0 1rem 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-color);
    }

    .namespace-box {
        background: #f8f9fa;
        padding: 0.75rem 1rem;
        border-radius: 6px;
        border-left: 4px solid var(--primary-color);
    }

    .namespace-box code {
        font-family: 'Consolas', 'Monaco', monospace;
        font-size: 1rem;
        color: var(--primary-color);
        font-weight: 600;
    }

    .using-list {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 6px;
        max-height: 300px;
        overflow-y: auto;
    }

    .using-item {
        padding: 0.25rem 0;
        font-family: 'Consolas', 'Monaco', monospace;
        font-size: 0.9rem;
    }

    .using-keyword {
        color: #0000ff;
        font-weight: 600;
        margin-right: 0.5rem;
    }

    .using-item code {
        color: #2c3e50;
    }

    .classes-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .class-item {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 8px;
        border-left: 4px solid var(--primary-color);
    }

    .class-item.interface {
        border-left-color: #9c27b0;
    }

    .class-header {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
        flex-wrap: wrap;
    }

    .class-icon {
        font-size: 1.2rem;
    }

    .class-keyword {
        color: #0000ff;
        font-weight: 600;
        font-family: 'Consolas', 'Monaco', monospace;
        font-size: 0.9rem;
    }

    .base-types {
        color: var(--text-muted);
        font-size: 0.9rem;
        font-family: 'Consolas', 'Monaco', monospace;
    }

    .class-members {
        margin-top: 0.75rem;
        padding-top: 0.75rem;
        border-top: 1px solid #dee2e6;
    }

    .members-section {
        margin-bottom: 1rem;
    }

    .members-section:last-child {
        margin-bottom: 0;
    }

    .members-title {
        font-weight: 600;
        font-size: 0.85rem;
        color: #6c757d;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .member-item {
        padding: 0.35rem 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
    }

    .member-icon {
        font-size: 0.85rem;
    }

    .member-item code {
        font-family: 'Consolas', 'Monaco', monospace;
        color: #2c3e50;
    }

    .member-access {
        color: #6c757d;
        font-size: 0.8rem;
        font-style: italic;
    }

    .tests-section {
        margin-top: 0.75rem;
        padding-top: 0.75rem;
        border-top: 1px solid #dee2e6;
    }

    .tests-title {
        font-weight: 600;
        font-size: 0.85rem;
        color: #28a745;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .test-item {
        padding: 0.35rem 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
    }

    .test-icon {
        font-size: 0.85rem;
    }

    .test-item code {
        font-family: 'Consolas', 'Monaco', monospace;
        color: #2c3e50;
    }

    .test-framework {
        color: #6c757d;
        font-size: 0.8rem;
        font-style: italic;
    }

    .file-detail-empty {
        text-align: center;
        padding: 4rem 2rem;
        color: var(--text-muted);
    }

    .empty-icon {
        font-size: 5rem;
        margin-bottom: 1rem;
        opacity: 0.3;
    }

    .file-detail-empty h3 {
        margin: 0 0 0.5rem 0;
        font-size: 1.5rem;
    }

    .file-detail-empty p {
        margin: 0;
        font-size: 1rem;
    }
</style>
